const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./postprocessing-vendor-m2O5L31u.js","./three-vendor-B_b-ez0R.js","./rapier-vendor-DUvx2jTT.js"])))=>i.map(i=>d[i]);
import{a as t,k as e,m as P,_ as B,P as D,C as H}from"./rapier-vendor-DUvx2jTT.js";import{M as L,C as N,E,T as R,S as X,a as W,O as Y,b as K,c as J}from"./drei-vendor-Dth15coJ.js";import{aW as Q,I as U,aX as Z,C as $}from"./three-vendor-B_b-ez0R.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();class ee{ctx=null;constructor(){try{const s=window,o=s.AudioContext??s.webkitAudioContext;o&&(this.ctx=new o)}catch{console.error("Web Audio API not supported")}}init(){this.ctx&&this.ctx.state==="suspended"&&this.ctx.resume()}playSpawnSound(){if(this.init(),!this.ctx)return;const s=this.ctx.createOscillator(),o=this.ctx.createGain();s.connect(o),o.connect(this.ctx.destination),s.type="sine",s.frequency.setValueAtTime(400,this.ctx.currentTime),s.frequency.exponentialRampToValueAtTime(100,this.ctx.currentTime+.3),o.gain.setValueAtTime(.3,this.ctx.currentTime),o.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+.3),s.start(),s.stop(this.ctx.currentTime+.3)}playBumpSound(){if(this.init(),!this.ctx)return;const s=this.ctx.createOscillator(),o=this.ctx.createGain();s.connect(o),o.connect(this.ctx.destination),s.type="triangle",s.frequency.setValueAtTime(100,this.ctx.currentTime),s.frequency.exponentialRampToValueAtTime(50,this.ctx.currentTime+.1),o.gain.setValueAtTime(.2,this.ctx.currentTime),o.gain.exponentialRampToValueAtTime(.01,this.ctx.currentTime+.1),s.start(),s.stop(this.ctx.currentTime+.1)}}const O=new ee,te={octahedron:new Z(.5,0),icosahedron:new U(.45,0),dodecahedron:new Q(.4,0)},se=({position:i,geometry:s,hue:o})=>{const c=t.useRef(null),r=t.useMemo(()=>new $().setHSL(o,1,.5),[o]);return t.useEffect(()=>{if(c.current){const a=(Math.random()-.5)*5,l=(Math.random()-.5)*5,d=(Math.random()-.5)*2;c.current.applyImpulse({x:a,y:l,z:d},!0),c.current.applyTorqueImpulse({x:Math.random(),y:Math.random(),z:Math.random()},!0)}},[]),e.jsx(P,{ref:c,position:i,restitution:.5,colliders:"hull",onCollisionEnter:()=>O.playBumpSound(),children:e.jsxs("mesh",{castShadow:!0,receiveShadow:!0,children:[e.jsx("primitive",{attach:"geometry",object:te[s]}),e.jsx(L,{backside:!1,samples:4,thickness:.5,chromaticAberration:.5,anisotropy:.5,distortion:.5,distortionScale:.5,temporalDistortion:.1,iridescence:1,iridescenceIOR:1,iridescenceThicknessRange:[0,1400],color:r,toneMapped:!1})]})})},A=["octahedron","icosahedron","dodecahedron"],ne=t.forwardRef((i,s)=>{const o=i.maxItems??50,[c,r]=t.useState([]),[a,l]=t.useState(!1),[d,h]=t.useState(0),u=t.useRef(null),m=t.useCallback(()=>{O.playSpawnSound();const x=Date.now()+Math.random(),S=A[Math.floor(Math.random()*A.length)],g=Math.random(),I=[0,2,0];r(y=>{const f=[...y,{id:x,position:I,geometry:S,hue:g}];return f.length>o?f.slice(f.length-o):f}),h(1),setTimeout(()=>h(0),200),u.current&&u.current.position&&(u.current.position.z=-.1,setTimeout(()=>{u.current&&u.current.position&&(u.current.position.z=0)},100))},[o]),j=t.useCallback(()=>{r([])},[]);return t.useImperativeHandle(s,()=>({spawnItem:m,reset:j,getCount:()=>c.length}),[m,j,c.length]),e.jsxs("group",{children:[e.jsx(N,{maxYaw:.05*d,maxPitch:.05*d,maxRoll:.05*d,yawFrequency:10*d,pitchFrequency:10*d,rollFrequency:10*d,intensity:d,decay:!0,decayRate:.9}),e.jsxs(P,{type:"fixed",colliders:"trimesh",children:[e.jsxs("mesh",{position:[0,-3.5,0],receiveShadow:!0,castShadow:!0,children:[e.jsx("boxGeometry",{args:[5,1,4]}),e.jsx("meshStandardMaterial",{color:"#050505",roughness:.2,metalness:.8}),e.jsx(E,{color:"#00ffff",threshold:15})]}),e.jsxs("mesh",{position:[0,4,0],receiveShadow:!0,castShadow:!0,children:[e.jsx("boxGeometry",{args:[5,1.5,4]}),e.jsx("meshStandardMaterial",{color:"#050505",roughness:.2,metalness:.8}),e.jsx(E,{color:"#ff00ff",threshold:15})]}),e.jsxs("mesh",{position:[-2.25,0,0],receiveShadow:!0,castShadow:!0,children:[e.jsx("boxGeometry",{args:[.5,8,4]}),e.jsx("meshStandardMaterial",{color:"#111",roughness:.2,metalness:.8})]}),e.jsxs("mesh",{position:[2.25,0,0],receiveShadow:!0,castShadow:!0,children:[e.jsx("boxGeometry",{args:[.5,8,4]}),e.jsx("meshStandardMaterial",{color:"#111",roughness:.2,metalness:.8})]}),e.jsxs("mesh",{position:[0,0,-1.5],receiveShadow:!0,castShadow:!0,children:[e.jsx("boxGeometry",{args:[4,6,1]}),e.jsx("meshStandardMaterial",{color:"#000",roughness:.8})]})]}),e.jsxs(R,{position:[0,4,2.1],fontSize:.6,color:"#00ffff",anchorX:"center",anchorY:"middle",children:["COSMIC ARTIFACTS",e.jsx("meshBasicMaterial",{color:"#00ffff",toneMapped:!1})]}),e.jsx("pointLight",{position:[0,2,0],intensity:i.lightTopIntensity??20,distance:10,color:"#00ffff"}),e.jsx("pointLight",{position:[0,-2,0],intensity:i.lightBottomIntensity??10,distance:10,color:"#ff00ff"}),e.jsxs("mesh",{position:[0,.25,1.5],children:[e.jsx("planeGeometry",{args:[4,6]}),e.jsx(L,{thickness:.1,roughness:0,transmission:.98,ior:1.5,chromaticAberration:.04,anisotropy:.5,backside:!1})]}),e.jsxs("group",{position:[3.5,-1,1],rotation:[0,-.5,0],children:[e.jsxs("group",{ref:u,children:[e.jsxs("mesh",{onClick:m,onPointerOver:()=>{document.body.style.cursor="pointer",l(!0)},onPointerOut:()=>{document.body.style.cursor="auto",l(!1)},rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.4,.4,.2,32]}),e.jsx("meshStandardMaterial",{color:a?"#ff00ff":"#aa00aa",emissive:a?"#ff00ff":"#aa00aa",emissiveIntensity:a?2:.5})]}),e.jsx(R,{position:[0,0,.15],fontSize:.1,color:"white",anchorX:"center",anchorY:"middle",children:"DISPENSE"})]}),e.jsxs("mesh",{position:[0,0,-.15],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.5,.5,.1,32]}),e.jsx("meshStandardMaterial",{color:"#333"})]})]}),d>0&&(i.sparklesEnabled??!0)&&e.jsx(X,{count:Math.round(50*(i.sparklesIntensity??1)),scale:4,size:6*(i.sparklesIntensity??1),speed:.4,opacity:1,color:"#00ffff",position:[0,2,0]}),c.map(x=>e.jsx(se,{position:x.position,geometry:x.geometry,hue:x.hue},x.id))]})}),oe=t.lazy(()=>B(()=>import("./postprocessing-vendor-m2O5L31u.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(i=>({default:i.EffectComposer}))),re=t.lazy(()=>B(()=>import("./postprocessing-vendor-m2O5L31u.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(i=>({default:i.Bloom}))),ae=({vmRef:i,bloomEnabled:s=!0,bloomIntensity:o=2,starsEnabled:c=!0,gridEnabled:r=!0,sparklesEnabled:a=!0,sparklesIntensity:l=1,lightTopIntensity:d=20,lightBottomIntensity:h=10,maxItems:u})=>e.jsxs(e.Fragment,{children:[e.jsx("color",{attach:"background",args:["#050505"]}),c&&e.jsx(W,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:1}),r&&e.jsx("gridHelper",{args:[50,50,"#222","#111"],position:[0,-4,0]}),e.jsx("ambientLight",{intensity:.2}),e.jsx("spotLight",{position:[10,10,10],angle:.5,penumbra:1,intensity:5,color:"#00ffff",castShadow:!0}),e.jsx("pointLight",{position:[-10,5,-10],intensity:5,color:"#ff00ff"}),e.jsx(D,{gravity:[0,0,0],children:e.jsx(ne,{ref:i,sparklesEnabled:a,sparklesIntensity:l,lightTopIntensity:d,lightBottomIntensity:h,maxItems:u})}),s&&e.jsx(t.Suspense,{fallback:null,children:e.jsx(oe,{children:e.jsx(re,{luminanceThreshold:.5,mipmapBlur:!0,intensity:o,radius:.6})})}),e.jsx(Y,{makeDefault:!0,minPolarAngle:0,maxPolarAngle:Math.PI/1.5}),e.jsx(K,{preset:"city",background:!1})]});function ie(){const i=t.useRef(null),[s,o]=t.useState(0),[c,r]=t.useState(0),[a,l]=t.useState(!0),[d,h]=t.useState(2),[u,m]=t.useState(!0),[j,x]=t.useState(!0),[S,g]=t.useState(!0),[I,y]=t.useState(1),[f,k]=t.useState(20),[w,v]=t.useState(10),[p,F]=t.useState(!1),[G,_]=t.useState("Balanced"),[q,M]=t.useState(!1),z=n=>{_(n),n==="Balanced"?(l(!0),h(2),m(!0),g(!0),y(1),k(20),v(10)):n==="Cinematic"?(l(!0),h(2.6),m(!0),g(!0),y(1.8),k(28),v(16)):(l(!1),h(0),m(!1),g(!1),y(0),k(8),v(6))};return t.useEffect(()=>{const n=setInterval(()=>{const b=i.current?.getCount()??0;o(b)},250);return()=>clearInterval(n)},[]),t.useEffect(()=>{let n=performance.now(),b=0;const C=T=>{const V=T-n;n=T,r(Math.round(1e3/Math.max(V,1))),b=requestAnimationFrame(C)};return b=requestAnimationFrame(C),()=>cancelAnimationFrame(b)},[]),e.jsxs("div",{style:{width:"100%",height:"100%",position:"relative"},children:[e.jsx(H,{shadows:!0,camera:{position:[0,0,8],fov:50},children:e.jsx(ae,{vmRef:i,bloomEnabled:p?!1:a,bloomIntensity:p?0:d,starsEnabled:p?!1:u,gridEnabled:j,sparklesEnabled:p?!1:S,sparklesIntensity:p?0:I,lightTopIntensity:p?Math.min(f,8):f,lightBottomIntensity:p?Math.min(w,6):w,maxItems:p?25:void 0})}),e.jsxs("div",{style:{position:"absolute",top:16,left:16,display:"flex",gap:12,alignItems:"center",background:"rgba(20,20,20,0.6)",padding:"10px 12px",borderRadius:8,color:"#fff",backdropFilter:"blur(6px)"},children:[e.jsx("button",{onClick:()=>i.current?.spawnItem(),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #00ffff",background:"#001b1b",color:"#00ffff"},children:"Dispense"}),e.jsx("button",{onClick:()=>i.current?.reset(),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ff00ff",background:"#1b001b",color:"#ff00ff"},children:"Reset"}),e.jsxs("span",{children:["Items: ",s]}),e.jsxs("span",{children:["FPS: ",c]}),e.jsx("button",{onClick:()=>M(!0),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #888",background:"#222",color:"#ddd"},children:"Settings"})]}),q&&e.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{width:520,maxWidth:"90%",background:"#111",color:"#fff",border:"1px solid #333",borderRadius:10,boxShadow:"0 8px 30px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid #222"},children:[e.jsx("div",{children:"Settings"}),e.jsx("button",{onClick:()=>M(!1),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #555",background:"#222",color:"#ddd"},children:"Close"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,padding:"14px 16px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:a,onChange:n=>l(n.target.checked)})," Bloom"]}),e.jsx("input",{type:"range",min:0,max:3,step:.1,value:d,onChange:n=>h(parseFloat(n.target.value))}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:u,onChange:n=>m(n.target.checked)})," Stars"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:n=>x(n.target.checked)})," Grid"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:S,onChange:n=>g(n.target.checked)})," Sparkles"]}),e.jsx("input",{type:"range",min:0,max:3,step:.1,value:I,onChange:n=>y(parseFloat(n.target.value))}),e.jsx("div",{children:"Top Light"}),e.jsx("input",{type:"range",min:0,max:40,step:1,value:f,onChange:n=>k(parseFloat(n.target.value))}),e.jsx("div",{children:"Bottom Light"}),e.jsx("input",{type:"range",min:0,max:40,step:1,value:w,onChange:n=>v(parseFloat(n.target.value))}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:p,onChange:n=>F(n.target.checked)})," Low Power Mode"]}),e.jsxs("select",{value:G,onChange:n=>z(n.target.value),style:{padding:"6px 10px",borderRadius:6},children:[e.jsx("option",{value:"Balanced",children:"Balanced"}),e.jsx("option",{value:"Cinematic",children:"Cinematic"}),e.jsx("option",{value:"Minimal",children:"Minimal"})]})]})]})})]})}J.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(ie,{})}));
